painted_galaxy_spawn_marauder_systems_2_and_3 = {
	random_system = {
		limit = {
			has_star_flag = marauder_capital_$NUMBER$
			# sanity check (because is_painted_galaxy is not 100% accurate)
			NOT = { any_neighbor_system = { has_star_flag = marauder_system } }
		}

		# set max_distance (for spawning systems) to 30
		set_variable = {
			which = painted_galaxy_marauder_max_distance
			value = 30
		}
		# if any system neighbor is closer, decrease the max_distance
		every_system = {
			export_trigger_value_to_variable = {
				variable = painted_galaxy_marauder_distance_to_capital
				trigger = distance
				parameters = {
					source = prev
					type = euclidean
				}
			}
			if = {
				limit = {
					check_variable = {
						which = painted_galaxy_marauder_distance_to_capital
						value < prev.painted_galaxy_marauder_max_distance
					}
				}
				prev = {
					set_variable = {
						which = painted_galaxy_marauder_max_distance
						value = prev.painted_galaxy_marauder_distance_to_capital
					}
				}
			}
			clear_variable = painted_galaxy_marauder_distance_to_capital
		}

		# spawn the systems
		# max_distance doesn't work with variables, so we need to check the variable outside of the spawn_system effect then pass it in
		if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 2 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 1 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 3 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 2 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 4 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 3 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 5 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 4 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 6 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 5 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 7 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 6 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 8 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 7 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 9 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 8 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 10 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 9 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 15 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 10 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 20 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 15 }
		} else_if = {
			limit = { check_variable = { which = painted_galaxy_marauder_max_distance value < 25 } }
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 20 }
		} else = {
			painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = { NUMBER = $NUMBER$ DISTANCE = 30 }
		}

		# connect systems 2 and 3 to each other
		event_target:painted_galaxy_marauder_$NUMBER$_2 = {
			if = {
				limit = { NOT = { has_hyperlane_to = event_target:painted_galaxy_marauder_$NUMBER$_3 } }
				add_hyperlane = { from = this to = event_target:painted_galaxy_marauder_$NUMBER$_3 }
			}
		}

		# cleanup
		clear_variable = painted_galaxy_marauder_max_distance
	}
}

painted_galaxy_spawn_marauder_systems_2_and_3_at_distance = {
	spawn_system = {
		initializer = marauder_$NUMBER$_2
		max_distance = $DISTANCE$
		effect = {
			save_event_target_as = painted_galaxy_marauder_$NUMBER$_2
			# connect to capital
			if = {
				limit = { NOT = { has_hyperlane_to = prev } }
				add_hyperlane = { from = this to = prev }
			}
		}
	}
	spawn_system = {
		initializer = marauder_$NUMBER$_3
		max_distance = $DISTANCE$
		effect = {
			save_event_target_as = painted_galaxy_marauder_$NUMBER$_3
			# connect to capital
			if = {
				limit = { NOT = { has_hyperlane_to = prev } }
				add_hyperlane = { from = this to = prev }
			}
		}
	}
}
